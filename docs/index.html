<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>SeoulBikeData</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="fullcontent">

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">SeoulBikeData</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="purpose" class="level2">
<h2 class="anchored" data-anchor-id="purpose">Purpose</h2>
<p>We are trying to find the best linear model (based on root mean square error) to predict the number of bikes rented in a day in Seoul.</p>
</section>
<section id="data-cleaning-and-eda" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning-and-eda">Data Cleaning and EDA</h2>
<p>We want to make the data nice to work with and we want to explore what it currently looks like to get a good idea of variables that will influence the prediction</p>
<p>Loading the libraries</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#---------------------Libraries-----------------------------------</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidymodels' was built under R version 4.5.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ────────────────────────────────────── tidymodels 1.4.1 ──</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ broom        1.0.10     ✔ recipes      1.3.1 
✔ dials        1.4.2      ✔ rsample      1.3.1 
✔ dplyr        1.1.4      ✔ tailor       0.1.0 
✔ ggplot2      4.0.0      ✔ tidyr        1.3.1 
✔ infer        1.0.9      ✔ tune         2.0.1 
✔ modeldata    1.5.1      ✔ workflows    1.3.0 
✔ parsnip      1.3.3      ✔ workflowsets 1.1.1 
✔ purrr        1.1.0      ✔ yardstick    1.3.2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'dials' was built under R version 4.5.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'infer' was built under R version 4.5.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'modeldata' was built under R version 4.5.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'parsnip' was built under R version 4.5.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'recipes' was built under R version 4.5.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'rsample' was built under R version 4.5.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tailor' was built under R version 4.5.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tune' was built under R version 4.5.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'workflows' was built under R version 4.5.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'workflowsets' was built under R version 4.5.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'yardstick' was built under R version 4.5.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──
✖ purrr::discard() masks scales::discard()
✖ dplyr::filter()  masks stats::filter()
✖ dplyr::lag()     masks stats::lag()
✖ recipes::step()  masks stats::step()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lubridate'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    date, intersect, setdiff, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'readr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:yardstick':

    spec</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:scales':

    col_factor</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'skimr' was built under R version 4.5.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'janitor' was built under R version 4.5.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'janitor'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    chisq.test, fisher.test</code></pre>
</div>
</div>
<p>Loading the data and pre-liminarily cleaning it</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------Data and basic prep-------------------------------------</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>bike_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://www4.stat.ncsu.edu/~online/datasets/SeoulBikeData.csv"</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">encoding=</span><span class="st">"latin1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 8760 Columns: 14
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (4): Date, Seasons, Holiday, Functioning Day
dbl (10): Rented Bike Count, Hour, Temperature(°C), Humidity(%), Wind speed ...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Number of missing data per column</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(bike_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     Date         Rented Bike Count                      Hour 
                        0                         0                         0 
          Temperature(°C)               Humidity(%)          Wind speed (m/s) 
                        0                         0                         0 
         Visibility (10m) Dew point temperature(°C)   Solar Radiation (MJ/m2) 
                        0                         0                         0 
             Rainfall(mm)             Snowfall (cm)                   Seasons 
                        0                         0                         0 
                  Holiday           Functioning Day 
                        0                         0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Number of columns and observations</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(bike_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8760   14</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(bike_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Date"                      "Rented Bike Count"        
 [3] "Hour"                      "Temperature(°C)"          
 [5] "Humidity(%)"               "Wind speed (m/s)"         
 [7] "Visibility (10m)"          "Dew point temperature(°C)"
 [9] "Solar Radiation (MJ/m2)"   "Rainfall(mm)"             
[11] "Snowfall (cm)"             "Seasons"                  
[13] "Holiday"                   "Functioning Day"          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Saving nice names in case we need to use them later (like in labeling)</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>bike_labels <span class="ot">&lt;-</span> <span class="fu">names</span>(bike_data)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Changing names so that manipulation is easier</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(bike_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"date"</span>, <span class="st">"rented_count"</span>, <span class="st">"hour"</span>, <span class="st">"temp"</span>, <span class="st">"humidity"</span>, <span class="st">"wind_speed"</span>,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"vis"</span>, <span class="st">"dew_temp"</span>, <span class="st">"solar_rad"</span>,<span class="st">"rainfall"</span>, <span class="st">"snowfall"</span>, <span class="st">"season"</span>, </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"holiday"</span>, <span class="st">"functioning_day"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="exploring-the-data-and-doing-other-necessary-cleaning" class="level3">
<h3 class="anchored" data-anchor-id="exploring-the-data-and-doing-other-necessary-cleaning">Exploring the data and doing other necessary cleaning</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------(personal) EDA and other prep -----------------------------</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co">#convert date from character to date object</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>bike_data <span class="ot">&lt;-</span> bike_data <span class="sc">|&gt;</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">dmy</span>(date))</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co">#simple numeric summaries</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>num_cols <span class="ot">&lt;-</span> bike_data <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">where</span>(is.numeric))</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(num_cols) <span class="co">#Gives numeric summary and (small) histograms</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">num_cols</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">8760</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 14%">
<col style="width: 10%">
<col style="width: 14%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">rented_count</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">704.60</td>
<td style="text-align: right;">645.00</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">191.00</td>
<td style="text-align: right;">504.50</td>
<td style="text-align: right;">1065.25</td>
<td style="text-align: right;">3556.00</td>
<td style="text-align: left;">▇▃▂▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">hour</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">11.50</td>
<td style="text-align: right;">6.92</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">5.75</td>
<td style="text-align: right;">11.50</td>
<td style="text-align: right;">17.25</td>
<td style="text-align: right;">23.00</td>
<td style="text-align: left;">▇▇▆▇▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">temp</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">12.88</td>
<td style="text-align: right;">11.94</td>
<td style="text-align: right;">-17.8</td>
<td style="text-align: right;">3.50</td>
<td style="text-align: right;">13.70</td>
<td style="text-align: right;">22.50</td>
<td style="text-align: right;">39.40</td>
<td style="text-align: left;">▂▆▆▇▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">humidity</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">58.23</td>
<td style="text-align: right;">20.36</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">42.00</td>
<td style="text-align: right;">57.00</td>
<td style="text-align: right;">74.00</td>
<td style="text-align: right;">98.00</td>
<td style="text-align: left;">▁▅▇▇▅</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wind_speed</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.72</td>
<td style="text-align: right;">1.04</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">1.50</td>
<td style="text-align: right;">2.30</td>
<td style="text-align: right;">7.40</td>
<td style="text-align: left;">▇▇▂▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">vis</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1436.83</td>
<td style="text-align: right;">608.30</td>
<td style="text-align: right;">27.0</td>
<td style="text-align: right;">940.00</td>
<td style="text-align: right;">1698.00</td>
<td style="text-align: right;">2000.00</td>
<td style="text-align: right;">2000.00</td>
<td style="text-align: left;">▂▂▂▂▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dew_temp</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4.07</td>
<td style="text-align: right;">13.06</td>
<td style="text-align: right;">-30.6</td>
<td style="text-align: right;">-4.70</td>
<td style="text-align: right;">5.10</td>
<td style="text-align: right;">14.80</td>
<td style="text-align: right;">27.20</td>
<td style="text-align: left;">▂▃▇▇▆</td>
</tr>
<tr class="even">
<td style="text-align: left;">solar_rad</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.87</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">3.52</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rainfall</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">1.13</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">35.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">snowfall</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">8.80</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#double checking that I understand what the skim histograms look like</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(bike_data<span class="sc">$</span>rented_count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Homework8Narrative_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(bike_data<span class="sc">$</span>solar_rad)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Homework8Narrative_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking uniqueness of categorical data</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>cat_cols <span class="ot">&lt;-</span> bike_data <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">names</span>(num_cols))</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>cat_cols</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8,760 × 4
   date       season holiday    functioning_day
   &lt;date&gt;     &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;          
 1 2017-12-01 Winter No Holiday Yes            
 2 2017-12-01 Winter No Holiday Yes            
 3 2017-12-01 Winter No Holiday Yes            
 4 2017-12-01 Winter No Holiday Yes            
 5 2017-12-01 Winter No Holiday Yes            
 6 2017-12-01 Winter No Holiday Yes            
 7 2017-12-01 Winter No Holiday Yes            
 8 2017-12-01 Winter No Holiday Yes            
 9 2017-12-01 Winter No Holiday Yes            
10 2017-12-01 Winter No Holiday Yes            
# ℹ 8,750 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>cat_cols <span class="sc">|&gt;</span> <span class="fu">tabyl</span>(season) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> season    n   percent
 Autumn 2184 0.2493151
 Spring 2208 0.2520548
 Summer 2208 0.2520548
 Winter 2160 0.2465753</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>cat_cols <span class="sc">|&gt;</span> <span class="fu">tabyl</span>(date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       date  n     percent
 2017-12-01 24 0.002739726
 2017-12-02 24 0.002739726
 2017-12-03 24 0.002739726
 2017-12-04 24 0.002739726
 2017-12-05 24 0.002739726
 2017-12-06 24 0.002739726
 2017-12-07 24 0.002739726
 2017-12-08 24 0.002739726
 2017-12-09 24 0.002739726
 2017-12-10 24 0.002739726
 2017-12-11 24 0.002739726
 2017-12-12 24 0.002739726
 2017-12-13 24 0.002739726
 2017-12-14 24 0.002739726
 2017-12-15 24 0.002739726
 2017-12-16 24 0.002739726
 2017-12-17 24 0.002739726
 2017-12-18 24 0.002739726
 2017-12-19 24 0.002739726
 2017-12-20 24 0.002739726
 2017-12-21 24 0.002739726
 2017-12-22 24 0.002739726
 2017-12-23 24 0.002739726
 2017-12-24 24 0.002739726
 2017-12-25 24 0.002739726
 2017-12-26 24 0.002739726
 2017-12-27 24 0.002739726
 2017-12-28 24 0.002739726
 2017-12-29 24 0.002739726
 2017-12-30 24 0.002739726
 2017-12-31 24 0.002739726
 2018-01-01 24 0.002739726
 2018-01-02 24 0.002739726
 2018-01-03 24 0.002739726
 2018-01-04 24 0.002739726
 2018-01-05 24 0.002739726
 2018-01-06 24 0.002739726
 2018-01-07 24 0.002739726
 2018-01-08 24 0.002739726
 2018-01-09 24 0.002739726
 2018-01-10 24 0.002739726
 2018-01-11 24 0.002739726
 2018-01-12 24 0.002739726
 2018-01-13 24 0.002739726
 2018-01-14 24 0.002739726
 2018-01-15 24 0.002739726
 2018-01-16 24 0.002739726
 2018-01-17 24 0.002739726
 2018-01-18 24 0.002739726
 2018-01-19 24 0.002739726
 2018-01-20 24 0.002739726
 2018-01-21 24 0.002739726
 2018-01-22 24 0.002739726
 2018-01-23 24 0.002739726
 2018-01-24 24 0.002739726
 2018-01-25 24 0.002739726
 2018-01-26 24 0.002739726
 2018-01-27 24 0.002739726
 2018-01-28 24 0.002739726
 2018-01-29 24 0.002739726
 2018-01-30 24 0.002739726
 2018-01-31 24 0.002739726
 2018-02-01 24 0.002739726
 2018-02-02 24 0.002739726
 2018-02-03 24 0.002739726
 2018-02-04 24 0.002739726
 2018-02-05 24 0.002739726
 2018-02-06 24 0.002739726
 2018-02-07 24 0.002739726
 2018-02-08 24 0.002739726
 2018-02-09 24 0.002739726
 2018-02-10 24 0.002739726
 2018-02-11 24 0.002739726
 2018-02-12 24 0.002739726
 2018-02-13 24 0.002739726
 2018-02-14 24 0.002739726
 2018-02-15 24 0.002739726
 2018-02-16 24 0.002739726
 2018-02-17 24 0.002739726
 2018-02-18 24 0.002739726
 2018-02-19 24 0.002739726
 2018-02-20 24 0.002739726
 2018-02-21 24 0.002739726
 2018-02-22 24 0.002739726
 2018-02-23 24 0.002739726
 2018-02-24 24 0.002739726
 2018-02-25 24 0.002739726
 2018-02-26 24 0.002739726
 2018-02-27 24 0.002739726
 2018-02-28 24 0.002739726
 2018-03-01 24 0.002739726
 2018-03-02 24 0.002739726
 2018-03-03 24 0.002739726
 2018-03-04 24 0.002739726
 2018-03-05 24 0.002739726
 2018-03-06 24 0.002739726
 2018-03-07 24 0.002739726
 2018-03-08 24 0.002739726
 2018-03-09 24 0.002739726
 2018-03-10 24 0.002739726
 2018-03-11 24 0.002739726
 2018-03-12 24 0.002739726
 2018-03-13 24 0.002739726
 2018-03-14 24 0.002739726
 2018-03-15 24 0.002739726
 2018-03-16 24 0.002739726
 2018-03-17 24 0.002739726
 2018-03-18 24 0.002739726
 2018-03-19 24 0.002739726
 2018-03-20 24 0.002739726
 2018-03-21 24 0.002739726
 2018-03-22 24 0.002739726
 2018-03-23 24 0.002739726
 2018-03-24 24 0.002739726
 2018-03-25 24 0.002739726
 2018-03-26 24 0.002739726
 2018-03-27 24 0.002739726
 2018-03-28 24 0.002739726
 2018-03-29 24 0.002739726
 2018-03-30 24 0.002739726
 2018-03-31 24 0.002739726
 2018-04-01 24 0.002739726
 2018-04-02 24 0.002739726
 2018-04-03 24 0.002739726
 2018-04-04 24 0.002739726
 2018-04-05 24 0.002739726
 2018-04-06 24 0.002739726
 2018-04-07 24 0.002739726
 2018-04-08 24 0.002739726
 2018-04-09 24 0.002739726
 2018-04-10 24 0.002739726
 2018-04-11 24 0.002739726
 2018-04-12 24 0.002739726
 2018-04-13 24 0.002739726
 2018-04-14 24 0.002739726
 2018-04-15 24 0.002739726
 2018-04-16 24 0.002739726
 2018-04-17 24 0.002739726
 2018-04-18 24 0.002739726
 2018-04-19 24 0.002739726
 2018-04-20 24 0.002739726
 2018-04-21 24 0.002739726
 2018-04-22 24 0.002739726
 2018-04-23 24 0.002739726
 2018-04-24 24 0.002739726
 2018-04-25 24 0.002739726
 2018-04-26 24 0.002739726
 2018-04-27 24 0.002739726
 2018-04-28 24 0.002739726
 2018-04-29 24 0.002739726
 2018-04-30 24 0.002739726
 2018-05-01 24 0.002739726
 2018-05-02 24 0.002739726
 2018-05-03 24 0.002739726
 2018-05-04 24 0.002739726
 2018-05-05 24 0.002739726
 2018-05-06 24 0.002739726
 2018-05-07 24 0.002739726
 2018-05-08 24 0.002739726
 2018-05-09 24 0.002739726
 2018-05-10 24 0.002739726
 2018-05-11 24 0.002739726
 2018-05-12 24 0.002739726
 2018-05-13 24 0.002739726
 2018-05-14 24 0.002739726
 2018-05-15 24 0.002739726
 2018-05-16 24 0.002739726
 2018-05-17 24 0.002739726
 2018-05-18 24 0.002739726
 2018-05-19 24 0.002739726
 2018-05-20 24 0.002739726
 2018-05-21 24 0.002739726
 2018-05-22 24 0.002739726
 2018-05-23 24 0.002739726
 2018-05-24 24 0.002739726
 2018-05-25 24 0.002739726
 2018-05-26 24 0.002739726
 2018-05-27 24 0.002739726
 2018-05-28 24 0.002739726
 2018-05-29 24 0.002739726
 2018-05-30 24 0.002739726
 2018-05-31 24 0.002739726
 2018-06-01 24 0.002739726
 2018-06-02 24 0.002739726
 2018-06-03 24 0.002739726
 2018-06-04 24 0.002739726
 2018-06-05 24 0.002739726
 2018-06-06 24 0.002739726
 2018-06-07 24 0.002739726
 2018-06-08 24 0.002739726
 2018-06-09 24 0.002739726
 2018-06-10 24 0.002739726
 2018-06-11 24 0.002739726
 2018-06-12 24 0.002739726
 2018-06-13 24 0.002739726
 2018-06-14 24 0.002739726
 2018-06-15 24 0.002739726
 2018-06-16 24 0.002739726
 2018-06-17 24 0.002739726
 2018-06-18 24 0.002739726
 2018-06-19 24 0.002739726
 2018-06-20 24 0.002739726
 2018-06-21 24 0.002739726
 2018-06-22 24 0.002739726
 2018-06-23 24 0.002739726
 2018-06-24 24 0.002739726
 2018-06-25 24 0.002739726
 2018-06-26 24 0.002739726
 2018-06-27 24 0.002739726
 2018-06-28 24 0.002739726
 2018-06-29 24 0.002739726
 2018-06-30 24 0.002739726
 2018-07-01 24 0.002739726
 2018-07-02 24 0.002739726
 2018-07-03 24 0.002739726
 2018-07-04 24 0.002739726
 2018-07-05 24 0.002739726
 2018-07-06 24 0.002739726
 2018-07-07 24 0.002739726
 2018-07-08 24 0.002739726
 2018-07-09 24 0.002739726
 2018-07-10 24 0.002739726
 2018-07-11 24 0.002739726
 2018-07-12 24 0.002739726
 2018-07-13 24 0.002739726
 2018-07-14 24 0.002739726
 2018-07-15 24 0.002739726
 2018-07-16 24 0.002739726
 2018-07-17 24 0.002739726
 2018-07-18 24 0.002739726
 2018-07-19 24 0.002739726
 2018-07-20 24 0.002739726
 2018-07-21 24 0.002739726
 2018-07-22 24 0.002739726
 2018-07-23 24 0.002739726
 2018-07-24 24 0.002739726
 2018-07-25 24 0.002739726
 2018-07-26 24 0.002739726
 2018-07-27 24 0.002739726
 2018-07-28 24 0.002739726
 2018-07-29 24 0.002739726
 2018-07-30 24 0.002739726
 2018-07-31 24 0.002739726
 2018-08-01 24 0.002739726
 2018-08-02 24 0.002739726
 2018-08-03 24 0.002739726
 2018-08-04 24 0.002739726
 2018-08-05 24 0.002739726
 2018-08-06 24 0.002739726
 2018-08-07 24 0.002739726
 2018-08-08 24 0.002739726
 2018-08-09 24 0.002739726
 2018-08-10 24 0.002739726
 2018-08-11 24 0.002739726
 2018-08-12 24 0.002739726
 2018-08-13 24 0.002739726
 2018-08-14 24 0.002739726
 2018-08-15 24 0.002739726
 2018-08-16 24 0.002739726
 2018-08-17 24 0.002739726
 2018-08-18 24 0.002739726
 2018-08-19 24 0.002739726
 2018-08-20 24 0.002739726
 2018-08-21 24 0.002739726
 2018-08-22 24 0.002739726
 2018-08-23 24 0.002739726
 2018-08-24 24 0.002739726
 2018-08-25 24 0.002739726
 2018-08-26 24 0.002739726
 2018-08-27 24 0.002739726
 2018-08-28 24 0.002739726
 2018-08-29 24 0.002739726
 2018-08-30 24 0.002739726
 2018-08-31 24 0.002739726
 2018-09-01 24 0.002739726
 2018-09-02 24 0.002739726
 2018-09-03 24 0.002739726
 2018-09-04 24 0.002739726
 2018-09-05 24 0.002739726
 2018-09-06 24 0.002739726
 2018-09-07 24 0.002739726
 2018-09-08 24 0.002739726
 2018-09-09 24 0.002739726
 2018-09-10 24 0.002739726
 2018-09-11 24 0.002739726
 2018-09-12 24 0.002739726
 2018-09-13 24 0.002739726
 2018-09-14 24 0.002739726
 2018-09-15 24 0.002739726
 2018-09-16 24 0.002739726
 2018-09-17 24 0.002739726
 2018-09-18 24 0.002739726
 2018-09-19 24 0.002739726
 2018-09-20 24 0.002739726
 2018-09-21 24 0.002739726
 2018-09-22 24 0.002739726
 2018-09-23 24 0.002739726
 2018-09-24 24 0.002739726
 2018-09-25 24 0.002739726
 2018-09-26 24 0.002739726
 2018-09-27 24 0.002739726
 2018-09-28 24 0.002739726
 2018-09-29 24 0.002739726
 2018-09-30 24 0.002739726
 2018-10-01 24 0.002739726
 2018-10-02 24 0.002739726
 2018-10-03 24 0.002739726
 2018-10-04 24 0.002739726
 2018-10-05 24 0.002739726
 2018-10-06 24 0.002739726
 2018-10-07 24 0.002739726
 2018-10-08 24 0.002739726
 2018-10-09 24 0.002739726
 2018-10-10 24 0.002739726
 2018-10-11 24 0.002739726
 2018-10-12 24 0.002739726
 2018-10-13 24 0.002739726
 2018-10-14 24 0.002739726
 2018-10-15 24 0.002739726
 2018-10-16 24 0.002739726
 2018-10-17 24 0.002739726
 2018-10-18 24 0.002739726
 2018-10-19 24 0.002739726
 2018-10-20 24 0.002739726
 2018-10-21 24 0.002739726
 2018-10-22 24 0.002739726
 2018-10-23 24 0.002739726
 2018-10-24 24 0.002739726
 2018-10-25 24 0.002739726
 2018-10-26 24 0.002739726
 2018-10-27 24 0.002739726
 2018-10-28 24 0.002739726
 2018-10-29 24 0.002739726
 2018-10-30 24 0.002739726
 2018-10-31 24 0.002739726
 2018-11-01 24 0.002739726
 2018-11-02 24 0.002739726
 2018-11-03 24 0.002739726
 2018-11-04 24 0.002739726
 2018-11-05 24 0.002739726
 2018-11-06 24 0.002739726
 2018-11-07 24 0.002739726
 2018-11-08 24 0.002739726
 2018-11-09 24 0.002739726
 2018-11-10 24 0.002739726
 2018-11-11 24 0.002739726
 2018-11-12 24 0.002739726
 2018-11-13 24 0.002739726
 2018-11-14 24 0.002739726
 2018-11-15 24 0.002739726
 2018-11-16 24 0.002739726
 2018-11-17 24 0.002739726
 2018-11-18 24 0.002739726
 2018-11-19 24 0.002739726
 2018-11-20 24 0.002739726
 2018-11-21 24 0.002739726
 2018-11-22 24 0.002739726
 2018-11-23 24 0.002739726
 2018-11-24 24 0.002739726
 2018-11-25 24 0.002739726
 2018-11-26 24 0.002739726
 2018-11-27 24 0.002739726
 2018-11-28 24 0.002739726
 2018-11-29 24 0.002739726
 2018-11-30 24 0.002739726</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>cat_cols <span class="sc">|&gt;</span> <span class="fu">tabyl</span>(holiday) <span class="co">#Strata? (5% holiday)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    holiday    n    percent
    Holiday  432 0.04931507
 No Holiday 8328 0.95068493</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>cat_cols <span class="sc">|&gt;</span> <span class="fu">tabyl</span>(functioning_day) <span class="co">#Strata? (4% no)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> functioning_day    n   percent
              No  295 0.0336758
             Yes 8465 0.9663242</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Set categorical variables to factors</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>bike_data <span class="ot">&lt;-</span> bike_data <span class="sc">|&gt;</span> </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"season"</span>, <span class="st">"holiday"</span>, <span class="st">"functioning_day"</span>), as.factor))</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co">#summaries of bike data (by itself and by categorical variables)</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bike_data<span class="sc">$</span>rented_count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    0.0   191.0   504.5   704.6  1065.2  3556.0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>bike_data <span class="sc">|&gt;</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(season) <span class="sc">|&gt;</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_rented =</span> <span class="fu">mean</span>(rented_count),</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_rented =</span> <span class="fu">median</span>(rented_count))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  season mean_rented median_rented
  &lt;fct&gt;        &lt;dbl&gt;         &lt;dbl&gt;
1 Autumn        820.          764.
2 Spring        730.          583 
3 Summer       1034.          906.
4 Winter        226.          203 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>bike_data <span class="sc">|&gt;</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(holiday) <span class="sc">|&gt;</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_rented =</span> <span class="fu">mean</span>(rented_count),</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_rented =</span> <span class="fu">median</span>(rented_count))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  holiday    mean_rented median_rented
  &lt;fct&gt;            &lt;dbl&gt;         &lt;dbl&gt;
1 Holiday           500.          240 
2 No Holiday        715.          524.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>bike_data <span class="sc">|&gt;</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(functioning_day) <span class="sc">|&gt;</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_rented =</span> <span class="fu">mean</span>(rented_count),</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_rented =</span> <span class="fu">median</span>(rented_count))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  functioning_day mean_rented median_rented
  &lt;fct&gt;                 &lt;dbl&gt;         &lt;dbl&gt;
1 No                       0              0
2 Yes                    729.           542</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># No bikes rented on non-functioning days, so taking out that column</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>bike_data <span class="ot">&lt;-</span> bike_data <span class="sc">|&gt;</span> <span class="fu">filter</span>(functioning_day <span class="sc">==</span> <span class="st">"Yes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>bike_data was filtered so that we only had days when the rental was functioning. Logically this makes sense, becaue there would be no rentals when it is not functioning, and that will hinder our prediction for the number of rentals when it is funcitoning</p>
<p>Creating new dataset that groups data by day instead of by hour</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Step 7:create new dataset to summarize across hours in a day</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>bike_daily <span class="ot">&lt;-</span> bike_data <span class="sc">|&gt;</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date, season, holiday) <span class="sc">|&gt;</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(rented_count, rainfall, snowfall), sum, <span class="at">.names =</span> <span class="st">"{.col}"</span>),</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(temp, humidity, wind_speed, vis, dew_temp, solar_rad), mean)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'date', 'season'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>bike_daily</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 353 × 12
   date       season holiday    rented_count rainfall snowfall    temp humidity
   &lt;date&gt;     &lt;fct&gt;  &lt;fct&gt;             &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
 1 2017-12-01 Winter No Holiday         9539      0        0   -2.45       45.9
 2 2017-12-02 Winter No Holiday         8523      0        0    1.32       62.0
 3 2017-12-03 Winter No Holiday         7222      4        0    4.88       81.5
 4 2017-12-04 Winter No Holiday         8729      0.1      0   -0.304      52.5
 5 2017-12-05 Winter No Holiday         8307      0        0   -4.46       36.4
 6 2017-12-06 Winter No Holiday         6669      1.3      8.6  0.0458     70.8
 7 2017-12-07 Winter No Holiday         8549      0       10.4  1.09       67.5
 8 2017-12-08 Winter No Holiday         8032      0        0   -3.82       41.8
 9 2017-12-09 Winter No Holiday         7233      0        0   -0.846      46  
10 2017-12-10 Winter No Holiday         3453      4.1     32.5  1.19       69.7
# ℹ 343 more rows
# ℹ 4 more variables: wind_speed &lt;dbl&gt;, vis &lt;dbl&gt;, dew_temp &lt;dbl&gt;,
#   solar_rad &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Doing similar Exploration with this new dataset</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Find summary statistics of all numeric variables</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>num_col_daily <span class="ot">&lt;-</span> bike_daily <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">where</span>(is.numeric))</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>bike_daily <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric),</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">list</span>(<span class="at">mean =</span> mean, <span class="at">median =</span> median, <span class="at">sd =</span> sd),</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `summarize()`.
ℹ In argument: `across(...)`.
Caused by warning:
! The `...` argument of `across()` is deprecated as of dplyr 1.1.0.
Supply arguments directly to `.fns` through an anonymous function instead.

  # Previously
  across(a:b, mean, na.rm = TRUE)

  # Now
  across(a:b, \(x) mean(x, na.rm = TRUE))</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 27
  rented_count_mean rented_count_median rented_count_sd rainfall_mean
              &lt;dbl&gt;               &lt;dbl&gt;           &lt;dbl&gt;         &lt;dbl&gt;
1            17485.               18563           9937.          3.58
# ℹ 23 more variables: rainfall_median &lt;dbl&gt;, rainfall_sd &lt;dbl&gt;,
#   snowfall_mean &lt;dbl&gt;, snowfall_median &lt;dbl&gt;, snowfall_sd &lt;dbl&gt;,
#   temp_mean &lt;dbl&gt;, temp_median &lt;dbl&gt;, temp_sd &lt;dbl&gt;, humidity_mean &lt;dbl&gt;,
#   humidity_median &lt;dbl&gt;, humidity_sd &lt;dbl&gt;, wind_speed_mean &lt;dbl&gt;,
#   wind_speed_median &lt;dbl&gt;, wind_speed_sd &lt;dbl&gt;, vis_mean &lt;dbl&gt;,
#   vis_median &lt;dbl&gt;, vis_sd &lt;dbl&gt;, dew_temp_mean &lt;dbl&gt;, dew_temp_median &lt;dbl&gt;,
#   dew_temp_sd &lt;dbl&gt;, solar_rad_mean &lt;dbl&gt;, solar_rad_median &lt;dbl&gt;, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Too many rows there, so let's just use skim again</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(num_col_daily)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">num_col_daily</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">353</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 13%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">rented_count</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">17485.31</td>
<td style="text-align: right;">9937.16</td>
<td style="text-align: right;">977.00</td>
<td style="text-align: right;">6967.00</td>
<td style="text-align: right;">18563.00</td>
<td style="text-align: right;">26285.00</td>
<td style="text-align: right;">36149.00</td>
<td style="text-align: left;">▇▃▅▇▃</td>
</tr>
<tr class="even">
<td style="text-align: left;">rainfall</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.58</td>
<td style="text-align: right;">11.79</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">95.50</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">snowfall</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.86</td>
<td style="text-align: right;">8.80</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">78.70</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">temp</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">12.78</td>
<td style="text-align: right;">11.72</td>
<td style="text-align: right;">-14.74</td>
<td style="text-align: right;">3.30</td>
<td style="text-align: right;">13.74</td>
<td style="text-align: right;">22.59</td>
<td style="text-align: right;">33.74</td>
<td style="text-align: left;">▂▆▆▇▅</td>
</tr>
<tr class="odd">
<td style="text-align: left;">humidity</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">58.17</td>
<td style="text-align: right;">14.87</td>
<td style="text-align: right;">22.25</td>
<td style="text-align: right;">47.58</td>
<td style="text-align: right;">57.17</td>
<td style="text-align: right;">67.71</td>
<td style="text-align: right;">95.88</td>
<td style="text-align: left;">▂▆▇▃▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">wind_speed</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.73</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: right;">0.66</td>
<td style="text-align: right;">1.30</td>
<td style="text-align: right;">1.66</td>
<td style="text-align: right;">1.95</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: left;">▅▇▂▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">vis</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1434.01</td>
<td style="text-align: right;">491.16</td>
<td style="text-align: right;">214.29</td>
<td style="text-align: right;">1087.04</td>
<td style="text-align: right;">1557.75</td>
<td style="text-align: right;">1874.29</td>
<td style="text-align: right;">2000.00</td>
<td style="text-align: left;">▂▂▃▅▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">dew_temp</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.95</td>
<td style="text-align: right;">12.99</td>
<td style="text-align: right;">-27.75</td>
<td style="text-align: right;">-5.19</td>
<td style="text-align: right;">4.61</td>
<td style="text-align: right;">14.92</td>
<td style="text-align: right;">25.04</td>
<td style="text-align: left;">▂▅▇▇▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">solar_rad</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">0.82</td>
<td style="text-align: right;">1.22</td>
<td style="text-align: left;">▇▇▇▇▅</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Finding correlations and plotting</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>cor_mat <span class="ot">&lt;-</span><span class="fu">cor</span>(num_col_daily)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>cor_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(cor_mat))</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cor_df, <span class="fu">aes</span>(Var1, Var2, <span class="at">fill =</span> Freq)) <span class="sc">+</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"red"</span>, <span class="at">high =</span> <span class="st">"blue"</span>, <span class="at">mid =</span> <span class="st">"purple"</span>,</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">name =</span> <span class="st">"Correlation"</span>) <span class="sc">+</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title =</span> <span class="st">"Correlation Heatmap"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Homework8Narrative_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Now by categorical variables</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>bike_daily <span class="sc">|&gt;</span> </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(season) <span class="sc">|&gt;</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_rented =</span> <span class="fu">mean</span>(rented_count),</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_rented =</span> <span class="fu">median</span>(rented_count))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  season mean_rented median_rented
  &lt;fct&gt;        &lt;dbl&gt;         &lt;dbl&gt;
1 Autumn      22099.        23350 
2 Spring      17910.        17590 
3 Summer      24818.        25572.
4 Winter       5413.         5498 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>bike_daily <span class="sc">|&gt;</span> </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(holiday) <span class="sc">|&gt;</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">sum</span>(rented_count),</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_rented =</span> <span class="fu">mean</span>(rented_count),</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_rented =</span> <span class="fu">median</span>(rented_count))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  holiday      count mean_rented median_rented
  &lt;fct&gt;        &lt;dbl&gt;       &lt;dbl&gt;         &lt;dbl&gt;
1 Holiday     215895      12700.         7184 
2 No Holiday 5956419      17727.        19104.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Visualize by categorical data</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(bike_daily, <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> rented_count, <span class="at">fill =</span> season)) <span class="sc">+</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"seaon"</span>, <span class="at">y =</span> <span class="st">"rented bike count"</span>) <span class="sc">+</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Homework8Narrative_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(bike_daily, <span class="fu">aes</span>(<span class="at">x =</span> holiday, <span class="at">y =</span> rented_count, <span class="at">fill =</span> holiday)) <span class="sc">+</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"On a Holiday?"</span>, <span class="at">y =</span> <span class="st">"rented bike count"</span>) <span class="sc">+</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Homework8Narrative_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(bike_daily, <span class="fu">aes</span>(<span class="at">x =</span> rented_count, <span class="at">fill =</span> holiday)) <span class="sc">+</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> .<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Homework8Narrative_files/figure-html/unnamed-chunk-5-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(bike_daily, <span class="fu">aes</span>(<span class="at">x =</span> rented_count, <span class="at">fill =</span> season)) <span class="sc">+</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> .<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Homework8Narrative_files/figure-html/unnamed-chunk-5-5.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="prep-work-before-modeling" class="level2">
<h2 class="anchored" data-anchor-id="prep-work-before-modeling">Prep-work before modeling</h2>
<p>First step is to split the data between training and test. We want to stratify by season because (as we saw above) winter has a large impact on bike rentals. We split the data between training and testing to that we can validate how well our model fits data is has never seen. We are also further splitting the training data into 10 cross validation folds. This allows the models to have a more unbiased fit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------Split data-----------------------------------</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">222</span>) <span class="co">#ensures results are always the same</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>data_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(bike_daily, <span class="at">prop =</span> .<span class="dv">75</span>, <span class="at">strata =</span> <span class="st">"season"</span>)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Create data frames for the two sets</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> <span class="fu">training</span>(data_split)</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> <span class="fu">testing</span>(data_split)</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Create cross validation folds</span></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>cv_folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(train_data, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we will make the recipes. Recipes are a way to standarize what you want variables you want your model to measure. Here we are making 3 recipes. These recipes have number of bikes rented as the response variable and the rest of the variables as predictor except for the date. Instead of using the date as a predictor, ee create a new variable based on if the date was a weekend or weekday. Then we normalize all the predictors to make calculations easier. We also create “dummy variables” for all of the categorical data. This means that it creates variables that are only 1 or 0 (true or false) that has the same information as the original columns.</p>
<p>Recipe 2 adds interaction terms as specified in instructions. This is likely because they have very high correlations in the matrix above.</p>
<p>Recipe 3 squares all of the numeric variables. Now the interactions include the new squared variables as well.</p>
<p>Each recipe is baked because it is easier to troubleshoot them here than when fitting. For recipes 2 and 3, only the names were needed for troubleshooting</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------Recipes---------------------------------------</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co"># First recipe</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>recipe1 <span class="ot">&lt;-</span> <span class="fu">recipe</span>(rented_count <span class="sc">~</span> ., <span class="at">data =</span> train_data) <span class="sc">|&gt;</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_role</span>(date, <span class="at">new_role =</span> <span class="st">"ID"</span>) <span class="sc">|&gt;</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_date</span>(date, <span class="at">features =</span> <span class="st">"dow"</span>) <span class="sc">|&gt;</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">day_type =</span> <span class="fu">factor</span>(<span class="fu">if_else</span>(<span class="fu">as.numeric</span>(date_dow) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>), <span class="st">"weekend"</span>, <span class="st">"weekday"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rm</span>(date_dow) <span class="sc">|&gt;</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">|&gt;</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>())</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>recipe1 <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
   variable     type      role      source  
   &lt;chr&gt;        &lt;list&gt;    &lt;chr&gt;     &lt;chr&gt;   
 1 date         &lt;chr [1]&gt; ID        original
 2 season       &lt;chr [3]&gt; predictor original
 3 holiday      &lt;chr [3]&gt; predictor original
 4 rainfall     &lt;chr [2]&gt; predictor original
 5 snowfall     &lt;chr [2]&gt; predictor original
 6 temp         &lt;chr [2]&gt; predictor original
 7 humidity     &lt;chr [2]&gt; predictor original
 8 wind_speed   &lt;chr [2]&gt; predictor original
 9 vis          &lt;chr [2]&gt; predictor original
10 dew_temp     &lt;chr [2]&gt; predictor original
11 solar_rad    &lt;chr [2]&gt; predictor original
12 rented_count &lt;chr [2]&gt; outcome   original</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking for errors</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>recipe1 <span class="sc">|&gt;</span> </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>(<span class="at">training =</span> train_data) <span class="sc">|&gt;</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bake</span>(train_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 263 × 15
   date       rainfall snowfall  temp humidity wind_speed    vis dew_temp
   &lt;date&gt;        &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1 2018-09-01   -0.292   -0.230 1.09    0.218      -0.855 0.821     0.999
 2 2018-09-04   -0.292   -0.230 0.904   0.950       0.697 0.0483    1.03 
 3 2018-09-05   -0.292   -0.230 0.953   0.259       1.24  1.05      0.901
 4 2018-09-07   -0.148   -0.230 0.812  -0.0864      1.20  0.841     0.687
 5 2018-09-08   -0.292   -0.230 0.773  -0.663      -0.113 1.11      0.469
 6 2018-09-09   -0.292   -0.230 0.796  -0.608      -0.814 1.14      0.504
 7 2018-09-10   -0.292   -0.230 0.878  -0.564      -0.281 1.14      0.611
 8 2018-09-12   -0.292   -0.230 0.843  -0.435      -0.673 1.12      0.630
 9 2018-09-13   -0.292   -0.230 0.920   0.294      -0.828 1.12      0.915
10 2018-09-14   -0.244   -0.230 0.922   0.640      -0.700 1.05      1.01 
# ℹ 253 more rows
# ℹ 7 more variables: solar_rad &lt;dbl&gt;, rented_count &lt;dbl&gt;, season_Spring &lt;dbl&gt;,
#   season_Summer &lt;dbl&gt;, season_Winter &lt;dbl&gt;, holiday_No.Holiday &lt;dbl&gt;,
#   day_type_weekend &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add interaction terms as specified</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>recipe2 <span class="ot">&lt;-</span> </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recipe</span>(rented_count <span class="sc">~</span> ., <span class="at">data =</span> train_data) <span class="sc">|&gt;</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_role</span>(date, <span class="at">new_role =</span> <span class="st">"ID"</span>) <span class="sc">|&gt;</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_date</span>(date, <span class="at">features =</span> <span class="st">"dow"</span>) <span class="sc">|&gt;</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">day_type =</span> <span class="fu">factor</span>(<span class="fu">if_else</span>(<span class="fu">as.numeric</span>(date_dow) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>), <span class="st">"weekend"</span>, <span class="st">"weekday"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rm</span>(date_dow) <span class="sc">|&gt;</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">|&gt;</span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>())<span class="sc">|&gt;</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="at">terms =</span> <span class="sc">~</span> <span class="fu">starts_with</span>(<span class="st">"holiday"</span>)<span class="sc">:</span><span class="fu">starts_with</span>(<span class="st">"seas"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="at">terms =</span> <span class="sc">~</span> temp<span class="sc">:</span><span class="fu">starts_with</span>(<span class="st">"season"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="at">terms =</span> <span class="sc">~</span> temp<span class="sc">:</span>rainfall)</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking for errors</span></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>recipe2 <span class="sc">|&gt;</span> </span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>(<span class="at">training =</span> train_data) <span class="sc">|&gt;</span></span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bake</span>(<span class="at">new_data =</span> <span class="cn">NULL</span>) <span class="sc">|&gt;</span> <span class="fu">names</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "date"                               "rainfall"                          
 [3] "snowfall"                           "temp"                              
 [5] "humidity"                           "wind_speed"                        
 [7] "vis"                                "dew_temp"                          
 [9] "solar_rad"                          "rented_count"                      
[11] "season_Spring"                      "season_Summer"                     
[13] "season_Winter"                      "holiday_No.Holiday"                
[15] "day_type_weekend"                   "holiday_No.Holiday_x_season_Spring"
[17] "holiday_No.Holiday_x_season_Summer" "holiday_No.Holiday_x_season_Winter"
[19] "temp_x_season_Spring"               "temp_x_season_Summer"              
[21] "temp_x_season_Winter"               "temp_x_rainfall"                   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add squared numeric terms. Unsure if we should also use the square interactions, but it can only over-fit the data</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>recipe3 <span class="ot">&lt;-</span> </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recipe</span>(rented_count <span class="sc">~</span> ., <span class="at">data =</span> train_data) <span class="sc">|&gt;</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_role</span>(date, <span class="at">new_role =</span> <span class="st">"ID"</span>) <span class="sc">|&gt;</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_date</span>(date, <span class="at">features =</span> <span class="st">"dow"</span>) <span class="sc">|&gt;</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">day_type =</span> <span class="fu">factor</span>(<span class="fu">if_else</span>(<span class="fu">as.numeric</span>(date_dow) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>), <span class="st">"weekend"</span>, <span class="st">"weekday"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rm</span>(date_dow) <span class="sc">|&gt;</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">|&gt;</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_poly</span>(<span class="fu">all_numeric_predictors</span>(), <span class="at">degree =</span> <span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>())<span class="sc">|&gt;</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="at">terms =</span> <span class="sc">~</span> <span class="fu">starts_with</span>(<span class="st">"holiday"</span>)<span class="sc">:</span><span class="fu">starts_with</span>(<span class="st">"seas"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="at">terms =</span> <span class="sc">~</span> <span class="fu">starts_with</span>(<span class="st">"temp"</span>)<span class="sc">:</span><span class="fu">starts_with</span>(<span class="st">"season"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="at">terms =</span> <span class="sc">~</span> <span class="fu">starts_with</span>(<span class="st">"temp"</span>)<span class="sc">:</span><span class="fu">starts_with</span>(<span class="st">"rainfall"</span>)) </span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>recipe3 <span class="sc">|&gt;</span> </span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>(<span class="at">training =</span> train_data) <span class="sc">|&gt;</span></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bake</span>(<span class="at">new_data =</span> train_data) <span class="sc">|&gt;</span> <span class="fu">names</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "date"                                         
 [2] "rented_count"                                 
 [3] "rainfall_poly_1"                              
 [4] "rainfall_poly_2"                              
 [5] "snowfall_poly_1"                              
 [6] "snowfall_poly_2"                              
 [7] "temp_poly_1"                                  
 [8] "temp_poly_2"                                  
 [9] "humidity_poly_1"                              
[10] "humidity_poly_2"                              
[11] "wind_speed_poly_1"                            
[12] "wind_speed_poly_2"                            
[13] "vis_poly_1"                                   
[14] "vis_poly_2"                                   
[15] "dew_temp_poly_1"                              
[16] "dew_temp_poly_2"                              
[17] "solar_rad_poly_1"                             
[18] "solar_rad_poly_2"                             
[19] "season_Spring"                                
[20] "season_Summer"                                
[21] "season_Winter"                                
[22] "holiday_No.Holiday"                           
[23] "day_type_weekend"                             
[24] "holiday_No.Holiday_x_season_Spring"           
[25] "holiday_No.Holiday_x_season_Summer"           
[26] "holiday_No.Holiday_x_season_Winter"           
[27] "temp_poly_1_x_season_Spring"                  
[28] "temp_poly_1_x_season_Summer"                  
[29] "temp_poly_1_x_season_Winter"                  
[30] "temp_poly_2_x_season_Spring"                  
[31] "temp_poly_2_x_season_Summer"                  
[32] "temp_poly_2_x_season_Winter"                  
[33] "temp_poly_1_x_rainfall_poly_1"                
[34] "temp_poly_1_x_rainfall_poly_2"                
[35] "temp_poly_2_x_rainfall_poly_1"                
[36] "temp_poly_2_x_rainfall_poly_2"                
[37] "temp_poly_1_x_season_Spring_x_rainfall_poly_1"
[38] "temp_poly_1_x_season_Spring_x_rainfall_poly_2"
[39] "temp_poly_1_x_season_Summer_x_rainfall_poly_1"
[40] "temp_poly_1_x_season_Summer_x_rainfall_poly_2"
[41] "temp_poly_1_x_season_Winter_x_rainfall_poly_1"
[42] "temp_poly_1_x_season_Winter_x_rainfall_poly_2"
[43] "temp_poly_2_x_season_Spring_x_rainfall_poly_1"
[44] "temp_poly_2_x_season_Spring_x_rainfall_poly_2"
[45] "temp_poly_2_x_season_Summer_x_rainfall_poly_1"
[46] "temp_poly_2_x_season_Summer_x_rainfall_poly_2"
[47] "temp_poly_2_x_season_Winter_x_rainfall_poly_1"
[48] "temp_poly_2_x_season_Winter_x_rainfall_poly_2"</code></pre>
</div>
</div>
</section>
<section id="modeling" class="level2">
<h2 class="anchored" data-anchor-id="modeling">Modeling</h2>
<p>Creating linear model and combining it with our recipes above to generate workflows. Workflows generalize the fitting process without data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------Model Fit with LM------------------------</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="co">#model</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>lm_mod <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">|&gt;</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"lm"</span>)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Workflows</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>wf1 <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(lm_mod) <span class="sc">|&gt;</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(recipe1)</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>wf2 <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(lm_mod) <span class="sc">|&gt;</span></span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(recipe2)</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>wf3 <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(lm_mod) <span class="sc">|&gt;</span></span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(recipe3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Generating the fits with crossvalidation. We are interested in root mean square error (rmse), so that is the metric that is set in the fits.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Fits with CV</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Defining metrics bc fit takes **forever** on my laptop (I had to use my mom's for the tutorial)</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>cv_fit1 <span class="ot">&lt;-</span> wf1 <span class="sc">|&gt;</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(<span class="at">resamples =</span> cv_folds,</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse))</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>cv_fit2 <span class="ot">&lt;-</span> wf2 <span class="sc">|&gt;</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(<span class="at">resamples =</span> cv_folds,</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse))</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>cv_fit3 <span class="ot">&lt;-</span> wf3 <span class="sc">|&gt;</span></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(<span class="at">resamples =</span> cv_folds,</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We determine the best fit based on the model with the lowest rmse. In this case, it is model 2. This means that the data is linear, but has some interactions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Getting metrics          RMSE</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">collect_metrics</span>(cv_fit1) <span class="co"># 4267</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  .metric .estimator  mean     n std_err .config        
  &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;          
1 rmse    standard   4031.    10    229. pre0_mod0_post0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">collect_metrics</span>(cv_fit2) <span class="co"># 3032</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  .metric .estimator  mean     n std_err .config        
  &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;          
1 rmse    standard   2926.    10    190. pre0_mod0_post0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">collect_metrics</span>(cv_fit3) <span class="co"># 8173</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  .metric .estimator  mean     n std_err .config        
  &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;          
1 rmse    standard   4901.    10   1067. pre0_mod0_post0</code></pre>
</div>
</div>
</section>
<section id="final-steps" class="level2">
<h2 class="anchored" data-anchor-id="final-steps">Final steps</h2>
<p>We use the best model from the crossvalidation phase (model 2) and use that to fit the test data that we put aside 2 sections ago. We find that the rmse has increased, but not by much, so this model is good (when compared to the other two). Since we have determined that this model is good, we extract the coefficients so that we can create the linear equation in the future</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Finalize model with full dataset</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>best_fit <span class="ot">&lt;-</span> wf2 <span class="sc">|&gt;</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">last_fit</span>(data_split) </span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>best_fit <span class="sc">|&gt;</span> <span class="fu">collect_metrics</span>() <span class="co">#RMSE = 3115</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  .metric .estimator .estimate .config        
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;          
1 rmse    standard    3571.    pre0_mod0_post0
2 rsq     standard       0.878 pre0_mod0_post0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>coefficient_of_fit <span class="ot">&lt;-</span> best_fit <span class="sc">|&gt;</span> <span class="fu">extract_fit_parsnip</span>() <span class="sc">|&gt;</span> <span class="fu">tidy</span>()</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>coefficient_of_fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 21 × 5
   term          estimate std.error statistic  p.value
   &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1 (Intercept)     17436.     1396.    12.5   5.74e-28
 2 rainfall        -2414.      495.    -4.87  1.99e- 6
 3 snowfall         -117.      187.    -0.627 5.31e- 1
 4 temp            -3785.     3757.    -1.01  3.15e- 1
 5 humidity        -3314.     1312.    -2.53  1.22e- 2
 6 wind_speed       -511.      197.    -2.59  1.01e- 2
 7 vis               501.      251.     2.00  4.67e- 2
 8 dew_temp        10733.     4284.     2.51  1.29e- 2
 9 solar_rad        2846.      302.     9.43  3.39e-18
10 season_Spring     917.     2420.     0.379 7.05e- 1
# ℹ 11 more rows</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>